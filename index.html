<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Test</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <h1>Supabase Connection Test</h1>
    
    <div>
        <button onclick="testConnection()">Test Supabase Connection</button>
        <button onclick="testTables()">Test Tables</button>
        <button onclick="addTestMovie()">Add Test Movie</button>
    </div>

    <div id="result" style="margin-top: 20px; padding: 10px; border: 1px solid #ccc;"></div>

    <script>
        // Your Supabase Credentials
        const SUPABASE_URL = 'https://vpyhzixjiwlvflmrmywr.supabase.co';
        const SUPABASE_KEY = 'sb_publishable_O4F_qebV8fdyGm06vw6O0Q_zzLP9fSo'; // üî• ‡§Ø‡§π‡§æ‡§Å API key ‡§°‡§æ‡§≤‡•á‡§Ç

        const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        async function testConnection() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = 'Testing connection...';
            
            try {
                // Simple test query
                const { data, error } = await supabase.from('movies').select('count');
                
                if (error) {
                    resultDiv.innerHTML = `‚ùå ERROR: ${error.message}`;
                } else {
                    resultDiv.innerHTML = '‚úÖ Connection Successful! Supabase is working.';
                }
            } catch (error) {
                resultDiv.innerHTML = `‚ùå Connection Failed: ${error.message}`;
            }
        }

        async function testTables() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = 'Checking tables...';
            
            try {
                // Check if movies table exists
                const { data, error } = await supabase.from('movies').select('*').limit(1);
                
                if (error) {
                    resultDiv.innerHTML = `‚ùå Movies table error: ${error.message}`;
                } else {
                    resultDiv.innerHTML = '‚úÖ Movies table exists and is accessible.';
                }
            } catch (error) {
                resultDiv.innerHTML = `‚ùå Table check failed: ${error.message}`;
            }
        }

        async function addTestMovie() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = 'Adding test movie...';
            
            try {
                const { data, error } = await supabase.from('movies').insert([
                    {
                        title: 'Test Movie',
                        category: 'Action',
                        iframe_code: '<iframe width="100%" height="100%" src="https://www.youtube.com/embed/TcMBFSGVi1c" frameborder="0" allowfullscreen></iframe>',
                        description: 'This is a test movie'
                    }
                ]);

                if (error) {
                    resultDiv.innerHTML = `‚ùå Insert failed: ${error.message}`;
                } else {
                    resultDiv.innerHTML = '‚úÖ Test movie added successfully!';
                }
            } catch (error) {
                resultDiv.innerHTML = `‚ùå Insert failed: ${error.message}`;
            }
        }
    </script>
</body>
</html>
